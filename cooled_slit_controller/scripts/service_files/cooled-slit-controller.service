[Unit]
Description=Cooled Slit Controller Service
After=network.target

[Service]
Type=simple
User=root
Group=root
Environment="CONFIG_PATH=/opt/cooled_slit_controller/config/default_config.toml"
ExecStart=/opt/cooled_slit_controller/bin/cooled_slit_controller
ExecStartPost=/bin/bash -c 'sleep 1; chmod 666 /tmp/cooled_slit_controller.sock'
WorkingDirectory=/opt/cooled_slit_controller
Restart=always
RestartSec=5
StandardOutput=append:/var/log/cooled_slit_controller/stdout.log
StandardError=append:/var/log/cooled_slit_controller/stderr.log

# Create socket directory with proper permissions
PermissionsStartOnly=true
ExecStartPre=/bin/mkdir -p /tmp
ExecStartPre=/bin/rm -f /tmp/cooled_slit_controller.sock

[Install]
WantedBy=multi-user.target
